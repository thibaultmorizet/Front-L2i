<div class="general-content">
  <app-admin-header></app-admin-header>

  <main id="content">
    <div class="container">
      <p-toast></p-toast>

      <div class="card">
        <p-toolbar styleClass="mb-4 gap-2">
          <ng-template pTemplate="left">
            <button
              pButton
              pRipple
              label="New"
              icon="pi pi-plus"
              class="p-button-success mr-2"
              (click)="openNew()"
            ></button>
            <button
              pButton
              pRipple
              label="Delete"
              icon="pi pi-trash"
              class="p-button-danger"
              (click)="deleteSelectedBooks()"
              [disabled]="!selectedBooks || !selectedBooks.length"
            ></button>
          </ng-template>
        </p-toolbar>

        <p-table
          #dt
          [value]="books"
          [rows]="10"
          [paginator]="true"
          [globalFilterFields]="[
            'name',
            'country.name',
            'representative.name',
            'status'
          ]"
          [tableStyle]="{ 'min-width': '75rem' }"
          [(selection)]="selectedBooks"
          [rowHover]="true"
          dataKey="id"
          currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
          [showCurrentPageReport]="true"
        >
          <ng-template pTemplate="caption">
            <div class="flex align-items-center justify-content-between">
              <h5 class="m-0">Manage books</h5>
              <span class="p-input-icon-left">
                <i class="pi pi-search"></i>
                <input
                  pInputText
                  type="text"
                  (input)="dt.filterGlobal($event.target, 'contains')"
                  placeholder="Search..."
                />
              </span>
            </div>
          </ng-template>
          <ng-template pTemplate="header">
            <tr>
              <th style="width: 4rem">
                <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
              </th>
              <th pSortableColumn="name" style="min-width: 15rem">
                Name <p-sortIcon field="name"></p-sortIcon>
              </th>
              <th>Image</th>
              <th pSortableColumn="price">
                Price <p-sortIcon field="price"></p-sortIcon>
              </th>
              <th pSortableColumn="category" style="min-width: 10rem">
                Category <p-sortIcon field="category"></p-sortIcon>
              </th>
              <th pSortableColumn="inventoryStatus" style="min-width: 10rem">
                Status <p-sortIcon field="inventoryStatus"></p-sortIcon>
              </th>
              <th></th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-book>
            <tr>
              <td>
                <p-tableCheckbox [value]="book"></p-tableCheckbox>
              </td>
              <td>{{ book.title }}</td>
              <td>
                <img
                  [src]="'assets/showcase/images/demo/book/' + book.image"
                  [alt]="book.title"
                  width="100"
                  class="shadow-4"
                />
              </td>
              <td>{{ book.price | currency: "USD" }}</td>
              <td>{{ book.type }}</td>
              <td>
                <span
                  [class]="
                    'book-badge status-' +
                    (book.stock
                      ? book.stock.toLowerCase()
                      : '')
                  "
                  >{{ book.stock }}</span
                >
              </td>
              <td>
                <button
                  pButton
                  pRipple
                  icon="pi pi-pencil"
                  class="p-button-rounded p-button-success mr-2"
                  (click)="editBook(book)"
                ></button>
                <button
                  pButton
                  pRipple
                  icon="pi pi-trash"
                  class="p-button-rounded p-button-warning"
                  (click)="deletebook(book)"
                ></button>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="summary">
            <div class="flex align-items-center justify-content-between">
              In total there are {{ books ? books.length : 0 }} books.
            </div>
          </ng-template>
        </p-table>
      </div>

      <p-dialog
        [(visible)]="bookDialog"
        [style]="{ width: '450px' }"
        header="book Details"
        [modal]="true"
        styleClass="p-fluid"
      >
        <ng-template pTemplate="content">
          <img
            [src]="'assets/showcase/images/demo/book/' + book.image"
            [alt]="book.image"
            class="book-image"
            *ngIf="book.image"
          />
          <div class="field">
            <label for="name">Name</label>
            <input
              type="text"
              pInputText
              id="name"
              [(ngModel)]="book.title"
              required
              autofocus
            />
            <small class="p-error" *ngIf="submitted && !book.title"
              >Name is required.</small
            >
          </div>
          <div class="field">
            <label for="description">Description</label>
            <textarea
              id="description"
              pInputTextarea
              [(ngModel)]="book.summary"
              required
              rows="3"
              cols="20"
            ></textarea>
          </div>

          <div class="field">
            <label for="inventoryStatus">Inventory Status</label>
            <p-dropdown
              [(ngModel)]="book.stock"
              inputId="inventoryStatus"
              [options]="statuses"
              placeholder="Select"
            >
              <ng-template let-option pTemplate="item">
                <span [class]="'book-badge status-' + option.value">{{
                  option.label
                }}</span>
              </ng-template>
            </p-dropdown>
          </div>

          <div class="field">
            <label class="mb-3">Category</label>
            <div class="formgrid grid">
              <div class="field-radiobutton col-6">
                <p-radioButton
                  id="category1"
                  name="category"
                  value="Accessories"
                  [(ngModel)]="book.type"
                ></p-radioButton>
                <label for="category1">Accessories</label>
              </div>
              <div class="field-radiobutton col-6">
                <p-radioButton
                  id="category2"
                  name="category"
                  value="Clothing"
                  [(ngModel)]="book.type"
                ></p-radioButton>
                <label for="category2">Clothing</label>
              </div>
              <div class="field-radiobutton col-6">
                <p-radioButton
                  id="category3"
                  name="category"
                  value="Electronics"
                  [(ngModel)]="book.type"
                ></p-radioButton>
                <label for="category3">Electronics</label>
              </div>
              <div class="field-radiobutton col-6">
                <p-radioButton
                  id="category4"
                  name="category"
                  value="Fitness"
                  [(ngModel)]="book.type"
                ></p-radioButton>
                <label for="category4">Fitness</label>
              </div>
            </div>
          </div>

          <div class="formgrid grid">
            <div class="field col">
              <label for="price">Price</label>
              <p-inputNumber
                id="price"
                [(ngModel)]="book.unitpricettc"
                mode="currency"
                currency="USD"
                locale="en-US"
              ></p-inputNumber>
            </div>
            <div class="field col">
              <label for="quantity">Quantity</label>
              <p-inputNumber
                id="quantity"
                [(ngModel)]="book.stock"
              ></p-inputNumber>
            </div>
          </div>
        </ng-template>

        <ng-template pTemplate="footer">
          <button
            pButton
            pRipple
            label="Cancel"
            icon="pi pi-times"
            class="p-button-text"
            (click)="hideDialog()"
          ></button>
          <button
            pButton
            pRipple
            label="Save"
            icon="pi pi-check"
            class="p-button-text"
            (click)="saveBook()"
          ></button>
        </ng-template>
      </p-dialog>

      <p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>
    </div>
  </main>
  <app-admin-footer></app-admin-footer>
</div>
